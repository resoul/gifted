// i am - 588857471
// gifted - -1003114197160

curl -s -X POST https://api.telegram.org/bot8440671672:AAGTPxDVHItFeWSDFexPXW51dIMcIJrhuQY/sendMessage \
-d chat_id=-1003114197160 \
-d text="https://giftedemotions.netlify.app"

curl -s -X POST https://api.telegram.org/bot8440671672:AAGTPxDVHItFeWSDFexPXW51dIMcIJrhuQY/sendMessage \
-d chat_id=-1003114197160 \
-d text="–∏ –∑–∞–∫—Ä–µ–ø–ª—è—é –∞ —Ç–æ –≤—ã —Å—Ç–∞—Ä—ã–µ –µ—â–µ –∑–∞–±—É–¥–∏—Ç–µ, –π–æ—É"

curl -X POST "https://api.telegram.org/bot8440671672:AAGTPxDVHItFeWSDFexPXW51dIMcIJrhuQY/pinChatMessage" \
  -d "chat_id=-1003114197160" \
  -d "message_id=118"

curl -X POST "https://api.telegram.org/bot8440671672:AAGTPxDVHItFeWSDFexPXW51dIMcIJrhuQY/editMessageText" \
  -d "chat_id=-1003114197160" \
  -d "message_id=117" \
  -d "text=–±—Ä–∞—Ç—é–Ω–∏ –¥–∞–≤–∞–π—Ç–µ –ø—Ä–æ—Å—ã–ø–∞–π—Ç–µ—Å—å –¥–ª—è –≤–∞—Å —Ç–µ–º–∞ –µ—Å—Ç—å, –∞ —Ç–æ —Å–∏–¥–∏—Ç–µ –ø–µ—Ä–¥–∏—Ç–µ, –≥–æ —Å—é–¥–∞"


curl -X POST "https://api.telegram.org/bot8440671672:AAGTPxDVHItFeWSDFexPXW51dIMcIJrhuQY/setMessageReaction" \
  -H "Content-Type: application/json" \
  -d '{"chat_id": -1003114197160, "message_id": 118, "reaction": [{"type": "emoji", "emoji": "üî•"}], "is_big": false}'

// https://api.telegram.org/bot8440671672:AAGTPxDVHItFeWSDFexPXW51dIMcIJrhuQY/getUpdates

// https://giftedemotions.netlify.app

create or replace function public.send_telegram_notification()
returns trigger
language plpgsql
security definer
as $$
declare
    api_url text;
    message_text text;
    payload jsonb;
begin
    api_url := 'https://api.telegram.org/bot8440671672:AAGTPxDVHItFeWSDFexPXW51dIMcIJrhuQY/sendMessage';
    message_text := 'üî• *–ù–û–í–û–ï –°–û–û–ë–©–ï–ù–ò–ï* üî•' || chr(10) || chr(10) ||
                    'üë§ *–ò–º—è*: ' || NEW.name || chr(10) ||
                    'üìß *Email*: ' || NEW.email || chr(10) ||
                    'üí° *–¢–µ–º–∞*: ' || NEW.subject || chr(10) ||
                    'üìù *–°–æ–æ–±—â–µ–Ω–∏–µ*:' || chr(10) || NEW.message;

    payload := jsonb_build_object(
        'chat_id', '-1003114197160',
        'text', message_text,
        'parse_mode', 'Markdown'
    );

    perform supabase_functions.http_request(
        api_url,
        'POST',
        '{"Content-Type":"application/json"}',
        payload::text,
        '5000'
    );

    return NEW;
end;
$$;